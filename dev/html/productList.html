<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<link href="http://zion.meixincn.com/vendor/css/bootstrap.min.css" rel="stylesheet">
<link href="http://zion.meixincn.com/version/dist/css/productList.min.css" rel="stylesheet">
<body>
    <div id="main">
        <div id="product_head">
            <div class="header">
                <div class="product_logo">
                    <img src="http://zion.meixincn.com/version/dist/img/logo.png" alt="">
                </div>
                <ul>
                    <li class="active"><a href="">产品</a></li>
                    <li><a href="">订单</a></li>
                    <li><a href="">客户</a></li>
                    <li class="backstage"><a href="">内部管理</a></li>
                    <li class="user_img"><a href=""><img src="http://zion.meixincn.com/version/dist/img/user.png" alt=""></a></li>
                    <li class="user_img"><a href=""><img src="http://zion.meixincn.com/version/dist/img/exit.png" alt=""></a></li>
                </ul>
            </div>
        </div>
        <div id="product_content">
            <div class="product_main">
                <!--<div class="product_chunk">-->
                    <!--<h3>计划理财</h3>-->
                    <!--<div class="chunk_series">-->
                        <!--<table>-->
                            <!--<thead>-->
                                <!--<tr class="table_th">-->
                                    <!--<td class="w_270">安心计划6个月</td>-->
                                    <!--<td>预计年化</td>-->
                                    <!--<td>投资期限</td>-->
                                    <!--<td>起息时期</td>-->
                                    <!--<td>开售日期</td>-->
                                    <!--<td></td>-->
                                <!--</tr>-->
                            <!--</thead>-->

                            <!--<tbody>-->
                                <!--<tr>-->
                                    <!--<td><a href="" class="color_223976">AX12M20170201</a></td>-->
                                    <!--<td class="color_223976">8%</td>-->
                                    <!--<td class="color_223976">6个月</td>-->
                                    <!--<td class="color_223976">2017.03.01</td>-->
                                    <!--<td class="color_223976">2017.01.26</td>-->
                                    <!--<td class=""><a href="" class="state bg_yu">预售</a></td>-->
                                <!--</tr>-->
                                <!--<tr>-->
                                    <!--<td><a href="" class="color_223976">AX12M20170201</a></td>-->
                                    <!--<td class="color_223976">8%</td>-->
                                    <!--<td class="color_223976">6个月</td>-->
                                    <!--<td class="color_223976">2017.03.01</td>-->
                                    <!--<td class="color_223976">2017.01.26</td>-->
                                    <!--<td class=""><a href="" class="state bg_zai">在售</a></td>-->
                                <!--</tr>-->
                                <!--<tr>-->
                                    <!--<td><a href="" class="color_223976">AX12M20170201</a></td>-->
                                    <!--<td class="color_223976">8%</td>-->
                                    <!--<td class="color_223976">6个月</td>-->
                                    <!--<td class="color_223976">2017.03.01</td>-->
                                    <!--<td class="color_223976">2017.01.26</td>-->
                                    <!--<td class=""><a href="" class="state bg_qing">售罄</a></td>-->
                                <!--</tr>-->
                                <!--<tr>-->
                                    <!--<td></td>-->
                                    <!--<td></td>-->
                                    <!--<td></td>-->
                                    <!--<td></td>-->
                                    <!--<td></td>-->
                                    <!--<td class="unfold color_223976">查看其他售罄产品 <i class="glyphicon glyphicon-menu-down"></i></td>-->
                                <!--</tr>-->
                            <!--</tbody>-->
                            <!--&lt;!&ndash;<tr>&ndash;&gt;-->
                                <!--&lt;!&ndash;<td></td>&ndash;&gt;-->
                                <!--&lt;!&ndash;<td></td>&ndash;&gt;-->
                                <!--&lt;!&ndash;<td></td>&ndash;&gt;-->
                                <!--&lt;!&ndash;<td></td>&ndash;&gt;-->
                                <!--&lt;!&ndash;<td></td>&ndash;&gt;-->
                                <!--&lt;!&ndash;<td class="packup color_223976">隐藏其他售罄产品 <i class="glyphicon glyphicon-menu-up"></i></td>&ndash;&gt;-->
                            <!--&lt;!&ndash;</tr>&ndash;&gt;-->

                        <!--</table>-->

                    <!--</div>-->
                <!--</div>-->
            </div>
        </div>
    </div>
</body>
<script src="http://zion.meixincn.com/vendor/js/jquery-1.11.1.min.js" type="text/javascript"></script>
<script src="http://zion.meixincn.com/vendor/js/bootstrap.min.js" type="text/javascript"></script>
<script src="http://zion.meixincn.com/vendor/js/jquery.cookie.min.js" type="text/javascript"></script>
<script src="http://zion.meixincn.com/version/dist/js/common.min.js" type="text/javascript"></script>
<script>

//    var base_url = 'http://192.168.1.102:8001';
//    var base_url = 'https://zion-api.meixincn.com';
    $(function () {

        $.ajax({
            type: 'get',
            url: base_url + '/channel/product/list',
            contentType: "application/json; charset=utf-8",
            headers: {
                "mx_token": $.cookie('mx_token'),
                "mx_secret": $.cookie('mx_secret')
            },
            success: function (res) {
                var dom='',dom11='',domTitle='',domBody='',tableDom='';
                var ele = $('<div class="product_chunk"></div>');
                $.each(res.body,function (i,item) {
                    dom11='';
                    domBody = '';
                    domTitle='<h3>'+item.category_name+'</h3>'
                    $.each(item.product_info_list,function (key,val) {
                        tableDom='';
                        var big = '';
                        var small = '';
                        domBody='<tr class="table_th">' +
                            '<td>'+val.product_name+'</td>' +
                            '<td>预计年化</td>' +
                            '<td>投资期限</td>' +
                            '<td>起息时期</td>' +
                            '<td>开售日期</td>' +
                            '<td>停售日期</td>'+
                            '<td></td>'+
                            '</tr>'

                        if (val.product_detail_list.length>3){

                            $.each(val.product_detail_list,function (j,jtem) {
                                var statu = '';
                                if (jtem.status == 'OFFLINE'){
                                    statu = '<a href="productDetails.html?product_id='+jtem.id+'" class="state bg_qing">售罄</a>'
                                }
                                if (jtem.status == 'SOLD_OUT'){
                                    statu = '<a href="productDetails.html?product_id='+jtem.id+'" class="state bg_qing">售罄</a>'
                                }
                                if (jtem.status == 'FOR_INVEST'){
                                    statu = '<a href="productDetails.html?product_id='+jtem.id+'" class="state bg_zai">在售</a>'
                                }
                                if (jtem.status == 'FOR_APPOINTMENT'){
                                    statu = '<a href="productDetails.html?product_id='+jtem.id+'" class="state bg_yu">预售</a>'
                                }
                                if (j>2){
                                    big += '<tr class="big"><td><a href="productDetails.html?product_id='+jtem.id+'" class="color_223976">'+jtem.number+'</a></td>' +
                                        '<td>'+jtem.return_rate+'%</td>' +
                                        '<td>'+jtem.invest_term+'个月</td>' +
                                        '<td>'+jtem.close_fund_start_interest_day+'</td>' +
                                        '<td>'+jtem.start_sale_day+'</td>' +
                                        '<td>'+jtem.end_sale_day+'</td>' +
                                        '<td class="">'+statu+'</td></tr>';
                                } else {

                                    small += '<tr><td><a href="productDetails.html?product_id='+jtem.id+'" class="color_223976">'+jtem.number+'</a></td>' +
                                        '<td>'+jtem.return_rate+'%</td>' +
                                        '<td>'+jtem.invest_term+'个月</td>' +
                                        '<td>'+jtem.close_fund_start_interest_day+'</td>' +
                                        '<td>'+jtem.start_sale_day+'</td>' +
                                        '<td>'+jtem.end_sale_day+'</td>' +
                                        '<td class="">'+statu+'</td></tr>';
                                }
                                tableDom = small + big + '<tr> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td> <td class="unfold color_223976">查看其他售罄产品 <i class="glyphicon glyphicon-menu-down"></i></td> </tr>'
                            })

                        }else {

                            $.each(val.product_detail_list,function (j,jtem) {
                                var statu = '';
                                if (jtem.status == 'OFFLINE'){
                                    statu = '<a href="productDetails.html?product_id='+jtem.id+'" class="state bg_qing">售罄</a>'
                                }
                                if (jtem.status == 'SOLD_OUT'){
                                    statu = '<a href="productDetails.html?product_id='+jtem.id+'" class="state bg_qing">售罄</a>'
                                }
                                if (jtem.status == 'FOR_INVEST'){
                                    statu = '<a href="productDetails.html?product_id='+jtem.id+'" class="state bg_zai">在售</a>'
                                }
                                if (jtem.status == 'FOR_APPOINTMENT'){
                                    statu = '<a href="productDetails.html?product_id='+jtem.id+'" class="state bg_yu">预售</a>'
                                }
                                tableDom+='<tr><td><a href="productDetails.html?product_id='+jtem.id+'" class="color_223976">'+jtem.number+'</a></td>' +
                                    '<td>'+jtem.return_rate+'%</td>' +
                                    '<td>'+jtem.invest_term+'个月</td>' +
                                    '<td>'+jtem.close_fund_start_interest_day+'</td>' +
                                    '<td>'+jtem.start_sale_day+'</td>' +
                                    '<td>'+jtem.end_sale_day+'</td>' +
                                    '<td class="">'+statu+'</td></tr>';
                            })

                        }

                        dom11+='<table>'+domBody+tableDom+'</table>' ;
                    })
//                    tableDom=domBody
                    dom+=domTitle+dom11;
                })
                $('.product_main').append(dom)
            },
            error:function () {
            }
        })

    })

    window.onload = function () {

        if (!is_admin){
            $('.backstage').hide();
        }else {
            $('.backstage').show();
        }

        //列表显示隐藏函数
        $('body').on('click','.unfold', function () {
            $(this).closest('table').find('tr.big').show();
            $(this).html('隐藏其他售罄产品 <i class="glyphicon glyphicon-menu-up"></i>');
            $(this).removeClass('unfold').addClass('fold');
        }) ;
        $('body').on('click','.fold', function () {
            $(this).closest('table').find('tr.big').hide();
            $(this).html('隐藏其他售罄产品 <i class="glyphicon glyphicon-menu-down"></i>');
            $(this).removeClass('fold').addClass('unfold');
        })

    }








</script>

</html>