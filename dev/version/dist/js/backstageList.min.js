$('#product_head ul li[data-name="内部管理"]').addClass("active"),$(function(){$.ajax({type:"get",url:base_url+"/zion/channel/searchChannelList",data:{query:""},contentType:"application/json; charset=utf-8",headers:{mx_token:$.cookie("mx_token"),mx_secret:$.cookie("mx_secret")},success:function(a){if(console.log(a.body),a.body.length<1)$(".chart_body").html('<div style="width: 1170px;margin: 0 auto"><img style="width: 69px;height: 69px;display: block;margin: 20px auto" src="../version/dist/img/wu.png" alt=""><p class="text-center" style="margin: 0 auto;width: 100%;"> 暂无数据！ </p></div>'),$(".chart_head").css("border-bottom","1px solid #cccccc");else{$(".chart_head").css("border-bottom","none");var e="";$.each(a.body,function(a,o){null==o.amount&&(o.amount=0),e+='<tr> <td class="w_175"><a href="backstageDetails.html?id='+o.id+"&code="+o.code+'">'+o.code+'</a></td> <td class="w_160">'+o.name+'</td> <td class="w_190">'+o.phone+'</td> <td class="w_285">'+o.email+'</td> <td class="w_160">'+o.count+'</td> <td class="w_200">'+o.amount+"</td> </tr>"}),$(".chart_body").html(e)}},error:function(){}})}),$(".glyphicon-search").click(function(){$.ajax({type:"get",url:base_url+"/zion/channel/searchChannelList",data:{query:$(".search_input").val()},contentType:"application/json; charset=utf-8",headers:{mx_token:$.cookie("mx_token"),mx_secret:$.cookie("mx_secret")},success:function(a){if(console.log(a.body),a.body.length<1)$(".chart_body").html('<div style="width: 1170px;margin: 0 auto"><img style="width: 69px;height: 69px;display: block;margin: 20px auto" src="../version/dist/img/wu.png" alt=""><p class="text-center" style="margin: 0 auto;width: 100%;"> 暂无数据！ </p></div>'),$(".chart_head").css("border-bottom","1px solid #cccccc");else{$(".chart_head").css("border-bottom","none");var e="";$.each(a.body,function(a,o){null==o.amount&&(o.amount=0),e+='<tr> <td class="w_175"><a href="backstageDetails.html?id='+o.id+"&code="+o.code+'">'+o.code+'</a></td> <td class="w_160">'+o.name+'</td> <td class="w_190">'+o.phone+'</td> <td class="w_285">'+o.code+'</td> <td class="w_160">'+o.count+'</td> <td class="w_200">'+o.code+"</td> </tr>"}),$(".chart_body").html(e)}},error:function(){}})}),$(".add_btn").click(function(){$.ajax({type:"get",url:base_url+"/zion/channel/getChannelCode",contentType:"application/json; charset=utf-8",headers:{mx_token:$.cookie("mx_token"),mx_secret:$.cookie("mx_secret")},success:function(a){console.log(a.body),$("#code").html(a.body),$("#password").val(a.body),$(".add_counselor").modal("show")},error:function(){}})}),$("#name").blur(function(){""!=$("#name").val()?($("#name").parent().removeClass("has-error"),$(".name_caution").css("display","none")):($("#name").parent().addClass("has-error"),$(".name_caution").css("display","block"))}),$("#phone").blur(function(){$("#phone").val().length>10?($("#phone").parent().removeClass("has-error"),$(".phone_caution").css("display","none")):($("#phone").parent().addClass("has-error"),$(".phone_caution").css("display","block"))}),$("#email").blur(function(){var a=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/;a.test($("#email").val())?($("#email").parent().removeClass("has-error"),$(".email_caution").css("display","none")):($("#email").parent().addClass("has-error"),$(".email_caution").css("display","block"))}),$(".invest_create").click(function(){var a={};a.id="",""==$("#name").val()?($("#name").parent().addClass("has-error"),$(".name_caution").css("display","block")):a.name=$("#name").val(),""==$("#phone").val()?($("#phone").parent().addClass("has-error"),$(".phone_caution").css("display","block")):a.phone=$("#phone").val(),""==$("#email").val()?($("#email").parent().addClass("has-error"),$(".email_caution").css("display","block")):a.email=$("#email").val(),""!=$("#password").val()?a.code=$("#password").val():alert("首次登录密码不能为空！"),""!=$("#name").val()&&""!=$("#phone").val()&&""!=$("#email").val()&&""!=$("#password").val()&&(console.log("1"),$.ajax({type:"post",url:base_url+"/zion/channel/editChannel",data:JSON.stringify(a),contentType:"application/json; charset=utf-8",headers:{mx_token:$.cookie("mx_token"),mx_secret:$.cookie("mx_secret")},success:function(a){console.log(a.body),$(".add_counselor").modal("hide"),window.location.reload()},error:function(){alert("创建失败")}}))}),$(".invest_abolish").click(function(){$("#name").val(""),$(".name_caution").css("display","none"),$("#name").parent().removeClass("has-error"),$("#phone").val(""),$(".phone_caution").css("display","none"),$("#phone").parent().removeClass("has-error"),$("#email").val(""),$(".email_caution").css("display","none"),$("#email").parent().removeClass("has-error"),$(".add_counselor").modal("hide")}),$(".close_on").click(function(){$("#name").val(""),$(".name_caution").css("display","none"),$("#name").parent().removeClass("has-error"),$("#phone").val(""),$(".phone_caution").css("display","none"),$("#phone").parent().removeClass("has-error"),$("#email").val(""),$(".email_caution").css("display","none"),$("#email").parent().removeClass("has-error")});