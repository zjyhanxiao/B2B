var user_data={},phone=getUrlParam("phone")||"",partner_id=getUrlParam("partner_id")||"",product_id=getUrlParam("product_id")||"",order_number=getUrlParam("order_number")||"",access_token=getUrlParam("access_token")||"";""==access_token&&(window.location="/verify_code.html?product_id="+product_id+"&partner_id="+partner_id),$(function(){function a(){var a={type:"1"};getData({data:a,url:base_url+"/white_label/invest/access_bank_dic",async:!1,sucFn:n,failFn:u})}function n(a){var n=a.body;if(n&&null!=n){h=n;var e="";$.each(n,function(a,n){e+='<a><div class="col-md-4"><div class="form-line choose-bank dis_table"><div class="table_row"><span class="table_cell" style=" width: 30%; height:60px;"><img class="bank-icon"src="'+n.bank_url+'"alt=""></span><span  class="table_cell" style=" width: 70%; height:60px;"><p style="text-align: left;">'+n.bank_name_en+"</p></span></div></div></div></a>"}),e+='<a><div class="col-md-4"><div class="form-line choose-bank dis_table" style="width: 100%;"><div class="table_row"><span class="table_cell" style="width: 30%; height:60px;"><img class="bank-icon" style=" width: 38px"src="/version/dist/img/other_bank.png"alt=""></span><span class="table_cell" style=" width: 70%; height:60px;"><p style="text-align: left; font-size: 18px; line-height: 60px; color: #159bd6;">其他银行</p></span></div></div></div></a>',$(".bank-list").html(e)}}function e(){var a={type:"2"};getData({data:a,url:base_url+"/white_label/invest/access_bank_dic",async:!1,sucFn:s,failFn:u})}function s(a){var n=a.body;if(n&&null!=n){k=n;var e="";$.each(n,function(a,n){e+='<a><div class="col-md-4"><div class="form-line choose-bank dis_table"><div class="table_row"><span class="table_cell" style=" width: 30%; height:60px;"><img class="bank-icon"src="'+n.bank_url+'"alt=""></span><span  class="table_cell" style=" width: 70%; height:60px;"><p style="text-align: left;">'+n.bank_name_en+"</p></span></div></div></div></a>"}),e+='<a><div class="col-md-4"><div class="form-line choose-bank dis_table" style="width: 100%;"><div class="table_row"><span class="table_cell" style="width: 30%; height:60px;"><img class="bank-icon" style=" width: 38px"src="/version/dist/img/other_bank.png"alt=""></span><span class="table_cell" style=" width: 70%; height:60px;"><p style="text-align: left; font-size: 18px; line-height: 60px; color: #159bd6;">其他银行</p></span></div></div></div></a>',$(".bank-list").html(e)}}function t(a){var n=a.body;if(n&&null!=n){if(user_data=n,""!=user_data.bank_type&&null!=user_data.bank_type||(user_data.bank_type="NON_US"),"US"==n.bank_type&&null!=n.bank_us.swift_code){if($(".banks").hide(),n.bank_url&&n.bank_name_cn){var e=n.bank_us;e.bank_name_cn=n.bank_name_cn,e.bank_url=n.bank_url,r(e)}else o(n.bank_us);return!1}if("NON_US"==n.bank_type&&null!=n.bank_non_us.swift_code){if($(".banks").hide(),n.bank_url&&n.bank_name_cn){var s=n.bank_non_us;s.bank_name_cn=n.bank_name_cn,s.bank_url=n.bank_url,d(s)}else _(n.bank_non_us);return!1}}}function r(a){a&&(a.bank_url&&$(".bank-us .bank_url img").attr("src",a.bank_url),a.bank_name_en&&$(".bank-us .bank_name_en").html(a.bank_name_en),a.bank_name&&$(".bank-us .bank_name_en").html(a.bank_name),a.bank_swift_code&&$(".bank-us .swift_code").html("SWIFT："+a.bank_swift_code),a.swift_code&&$(".bank-us .swift_code").html("SWIFT："+a.swift_code),a.routing_number&&$(".bank-us .routing_number").val(a.routing_number),a.account_number&&$(".bank-us .account_number").val(a.account_number),"Savings"==a.account_type?$(".bank-us .account_type .savings").addClass("checked").siblings(".checking").removeClass("checked"):$(".bank-us .account_type .checking").addClass("checked").siblings(".savings").removeClass("checked")),$(".bank-us").show().siblings(".bank-us-other,.bank-cn,.bank-cn-other,.middle-bank").hide()}function d(a){a&&(""!=a.bank_url&&null!=a.bank_url&&void 0!=a.bank_url&&$(".bank-cn .bank_url img").attr("src",a.bank_url),a.bank_name_cn&&$(".bank-cn .bank_name_cn").html(a.bank_name_cn),a.bank_name_en&&$(".bank-cn .bank_name_en").html(a.bank_name_en),a.bank_name&&$(".bank-cn .bank_name_en").html(a.bank_name),a.swift_code&&$(".bank-cn .swift_code").html("SWIFT："+a.swift_code),a.bank_swift_code&&$(".bank-cn .swift_code").html("SWIFT："+a.bank_swift_code),a.account_number&&$(".bank-cn .account_number").val(a.account_number)),$(".bank-cn").show().siblings(".bank-us-other,.bank-us,.bank-cn-other,.middle-bank").hide()}function o(a){a&&(a.bank_name&&$(".bank-us-other .bank_name").val(a.bank_name),a.bank_address&&$(".bank-us-other .bank_address").val(a.bank_address),a.swift_code&&$(".bank-us-other .swift_code").val(a.swift_code),a.routing_number&&$(".bank-us-other .routing_number").val(a.routing_number),a.account_number&&$(".bank-us-other .account_number").val(a.account_number),"Savings"==a.account_type?$(".bank-us-other .account_type .savings").addClass("checked").siblings(".checking").removeClass("checked"):$(".bank-us-other .account_type .checking").addClass("checked").siblings(".savings").removeClass("checked")),$(".bank-us-other").show().siblings(".bank-cn,.bank-us,.bank-cn-other,.middle-bank").hide()}function _(a){a&&(a.bank_name&&$(".bank-cn-other .bank_name").val(a.bank_name),a.bank_address&&$(".bank-cn-other .bank_address").val(a.bank_address),a.swift_code&&$(".bank-cn-other .swift_code").val(a.swift_code),a.account_number&&$(".bank-cn-other .account_number").val(a.account_number),a.have_middle_bank&&($(".bank-cn-other .middle_bank_name").val(a.middle_bank_name),$(".bank-cn-other .middle_bank_address").val(a.middle_bank_address),$(".bank-cn-other .middle_bank_swift_code").val(a.middle_bank_swift_code))),$(".bank-cn-other,.middle-bank").show().siblings(".bank-us-other,.bank-us,.bank-cn").hide()}function b(){delete user_data.bank_url,delete user_data.bank_name_cn,delete user_data.bank_us.bank_url,delete user_data.bank_us.bank_name_cn,delete user_data.bank_non_us.bank_url,delete user_data.bank_non_us.bank_name_cn,""==order_number?(postData({url:base_url+"/zion/white_label/operate_user",data:JSON.stringify(user_data),async:!1,contentType:"application/json; charset=utf-8",sucFn:c,failFn:u}),postData({url:base_url+"/zion/white_label/create_order",data:JSON.stringify(user_data),async:!1,contentType:"application/json; charset=utf-8",sucFn:c,failFn:u})):postData({url:base_url+"/zion/white_label/operate_user",data:JSON.stringify(user_data),async:!1,contentType:"application/json; charset=utf-8",sucFn:c,failFn:u})}function c(a){var n=a.body;n&&n.order_number&&(order_number=n.order_number),""!==order_number&&(window.location="/white_label/signature.html?product_id="+product_id+"&phone="+phone+"&partner_id="+partner_id+"&access_token="+access_token+"&order_number="+order_number)}function u(a){alert(a.msg)}function l(a){console.log("合法用户")}function i(a){window.location="/verify_code.html?product_id="+product_id+"&partner_id="+partner_id}var k="",h="";getData({url:base_url+"/zion/common/verify_token",data:{phone:phone,access_token:access_token,channel_code:partner_id},async:!1,sucFn:l,failFn:i}),a(),""!=phone&&""!=access_token&&getData({url:base_url+"/zion/white_label/order_user_info",data:{phone:phone,access_token:access_token,channel_code:partner_id,order_number:order_number},async:!1,sucFn:t,failFn:u}),$(".step-three").on("click",function(){if(user_data.product_id=product_id,user_data.channel_code=partner_id,user_data.order_number=order_number,user_data.phone=phone,user_data.access_token=access_token,$(".error").remove(),$(this).prop("disabled",!0),"block"==$(".banks").css("display"))return $(".banks").append('<div class="error">请选择银行</div>'),!1;if("block"==$(".bank-us").css("display")){var a=!0;$(".bank-us .routing_number,.bank-us .account_number").css("border-color","#ccc").removeClass("red-shadow");var n=$(".bank-us .routing_number").val(),e=$(".bank-us .account_number").val(),s=$(".bank-us .account_type .checked").html();if(""==n&&($(".bank-us .routing_number").css("border-color","red").addClass("red-shadow"),a=!1),""==e&&($(".bank-us .account_number").css("border-color","red").addClass("red-shadow"),a=!1),a)user_data.bank_us.routing_number=n,user_data.bank_us.account_number=e,user_data.bank_us.account_type=s,b();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}if("block"==$(".bank-us-other").css("display")){var a=!0;$(".bank-us-other .bank_name,.bank-us-other .bank_address,.bank-us-other .swift_code,.bank-us-other .routing_number,.bank-us-other .account_number").css("border-color","#ccc").removeClass("red-shadow");var r=$(".bank-us-other .bank_name").val(),d=$(".bank-us-other .bank_address").val(),o=$(".bank-us-other .swift_code").val(),n=$(".bank-us-other .routing_number").val(),e=$(".bank-us-other .account_number").val(),s=$(".bank-us-other .account_type .checked").html();if(""==r&&($(".bank-us-other .bank_name").css("border-color","red").addClass("red-shadow"),a=!1),""==d&&($(".bank-us-other .bank_address").css("border-color","red").addClass("red-shadow"),a=!1),""==o&&""==n&&($(".bank-us-other .swift_code").css("border-color","red").addClass("red-shadow"),$(".bank-us-other .routing_number").css("border-color","red").addClass("red-shadow"),a=!1),""==e&&($(".bank-us-other .account_number").css("border-color","red").addClass("red-shadow"),a=!1),a)user_data.bank_us.bank_name=r,user_data.bank_us.bank_address=d,user_data.bank_us.routing_number=n,user_data.bank_us.swift_code=o,user_data.bank_us.account_number=e,user_data.bank_us.account_type=s,b();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}if("block"==$(".bank-cn").css("display")){var a=!0;$(".bank-cn .account_number").css("border-color","#ccc").removeClass("red-shadow");var e=$(".bank-cn .account_number").val();if(""==e&&($(".bank-us-other .account_number").css("border-color","red").addClass("red-shadow"),a=!1),a)user_data.bank_non_us.account_number=e,console.log(JSON.stringify(user_data)),b();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}if("block"==$(".bank-cn-other").css("display")){var a=!0;$(".bank-cn-other .bank_name,.bank-cn-other .bank_address,.bank-cn-other .swift_code,.bank-cn-other .account_number").css("border-color","#ccc").removeClass("red-shadow");var r=$(".bank-cn-other .bank_name").val(),d=$(".bank-cn-other .bank_address").val(),o=$(".bank-cn-other .swift_code").val(),e=$(".bank-cn-other .account_number").val(),_=$(".bank-cn-other .middle_bank_name").val(),c=$(".bank-cn-other .middle_bank_address").val(),u=$(".bank-cn-other .middle_bank_swift_code").val();if(""==r&&($(".bank-cn-other .bank_name").css("border-color","red").addClass("red-shadow"),a=!1),""==d&&($(".bank-cn-other .bank_address").css("border-color","red").addClass("red-shadow"),a=!1),""==o&&($(".bank-cn-other .swift_code").css("border-color","red").addClass("red-shadow"),a=!1),""==e&&($(".bank-cn-other .account_number").css("border-color","red").addClass("red-shadow"),a=!1),a)user_data.bank_non_us.bank_name=r,user_data.bank_non_us.bank_address=d,user_data.bank_non_us.swift_code=o,user_data.bank_non_us.account_number=e,""!=_&&""!=c&&""!=u&&(user_data.bank_non_us.have_middle_bank=1,user_data.bank_non_us.middle_bank_name=_,user_data.bank_non_us.middle_bank_address=c,user_data.bank_non_us.middle_bank_swift_code=u),b();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}return!1}),$(".prev-two").click(function(){window.location="/white_label/address_info.html?product_id="+product_id+"&phone="+phone+"&partner_id="+partner_id+"&order_number="+order_number+"&access_token="+access_token}),$(".banks").on("click",".button-white",function(){return $(this).addClass("button-blue").removeClass("button-white"),$(this).hasClass("non-us-bank")&&($(".us-bank").addClass("button-white").removeClass("button-blue"),user_data.bank_type="NON_US",a()),$(this).hasClass("us-bank")&&($(".non-us-bank").addClass("button-white").removeClass("button-blue"),user_data.bank_type="US",e()),!1}),$(".bank-list").on("click",".choose-bank",function(){$(".step-three").prop("disabled",!1),$(".banks").hide();var a=$(".bank-list a").length,n=$(this).closest("a").index();if(n<a-1){var e;if("US"==user_data.bank_type)return e=k[n],e.account_number="",user_data.bank_us.bank_name=e.bank_name_en,user_data.bank_us.bank_address=e.bank_address,user_data.bank_us.swift_code=e.bank_swift_code,user_data.bank_us.routing_number=e.routing_number,r(e),!1;if("NON_US"==user_data.bank_type)return e=h[n],e.account_number="",user_data.bank_non_us.bank_name=e.bank_name_en,user_data.bank_non_us.bank_address=e.bank_address,user_data.bank_non_us.swift_code=e.bank_swift_code,user_data.bank_non_us.middle_bank_name=e.middle_bank_name,user_data.bank_non_us.middle_bank_address=e.middle_bank_address,user_data.bank_non_us.middle_bank_swift_code=e.middle_bank_swift_code,""!=e.middle_bank_address&&""!=e.middle_bank_swift_code&&""!=e.middle_bank_address&&(user_data.bank_non_us.have_middle_bank=1),console.log(JSON.stringify(user_data)),d(e),!1}else{if("US"==user_data.bank_type)return o(),!1;if("NON_US"==user_data.bank_type)return _(),!1}return!1}),$(".account_type button").click(function(){return!$(this).hasClass("checked")&&void $(this).addClass("checked").siblings("button").removeClass("checked")}),$(".bank_border").on("click",function(){return $(".step-three").prop("disabled",!1),$("input,textarea").val(""),$(".error").remove(),"US"==user_data.bank_type?(e(),$(".us-bank").addClass("button-blue").removeClass("button-white"),$(".non-us-bank").addClass("button-white").removeClass("button-blue"),$(".banks").show().siblings(".bank-us,.bank-us-other,.bank-cn,.bank-cn-other,.middle-bank").hide(),!1):"NON_US"==user_data.bank_type?(a(),$(".us-bank").addClass("button-white").removeClass("button-blue"),$(".non-us-bank").addClass("button-blue").removeClass("button-white"),$(".banks").show().siblings(".bank-us,.bank-us-other,.bank-cn,.bank-cn-other,.middle-bank").hide(),!1):void 0}),$("input,textarea").focus(function(){$(this).css("border-color","#ccc")})});