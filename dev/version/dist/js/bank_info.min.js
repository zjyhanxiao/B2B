$(function(){function n(){var n={type:"1"};getData({data:n,url:base_url+"/white_label/invest/access_bank_dic",async:!1,sucFn:a,failFn:i})}function a(n){var a=n.body;if(a&&null!=a){p=a;var e="";$.each(a,function(n,a){e+='<a><div class="col-md-4"><div class="form-line choose-bank"><div style="float: left; width: 30%; height:60px;"><img class="bank-icon" style="margin-top: 10px;"src="'+a.bank_url+'"alt=""></div><div style="float: right; width: 70%; height:60px;"><p style="text-align: left;">'+a.bank_name_cn+'</p><p style="text-align: left;">'+a.bank_name_en+"</p></div></div></div></a>"}),e+='<a><div class="col-md-4"><div class="form-line choose-bank"><div style="float: left; width: 30%; height:60px;"><img class="bank-icon" style="margin-top: 10px; width: 38px"src="http://localhost:8080/version/dist/img/other_bank.png"alt=""></div><div style="float: right; width: 70%; height:60px;"><p style="text-align: left; font-size: 18px; line-height: 60px; color: #159bd6;">其他银行</p></div></div></div></a>',$(".bank-list").html(e)}}function e(){var n={type:"2"};getData({data:n,url:base_url+"/white_label/invest/access_bank_dic",async:!1,sucFn:s,failFn:i})}function s(n){var a=n.body;if(a&&null!=a){v=a;var e="";$.each(a,function(n,a){e+='<a><div class="col-md-4"><div class="form-line choose-bank"><div style="float: left; width: 30%; height:60px;"><img class="bank-icon" style="margin-top: 10px;"src="'+a.bank_url+'"alt=""></div><div style="float: right; width: 70%; height:60px;"><p style="text-align: left;">'+a.bank_name_en+"</p></div></div></div></a>"}),e+='<a><div class="col-md-4"><div class="form-line choose-bank"><div style="float: left; width: 30%; height:60px;"><img class="bank-icon" style="margin-top: 10px; width: 38px"src="http://localhost:8080/version/dist/img/other_bank.png"alt=""></div><div style="float: right; width: 70%; height:60px;"><p style="text-align: left; font-size: 18px; line-height: 60px; color: #159bd6;">其他银行</p></div></div></div></a>',$(".bank-list").html(e)}}function t(n){var a=n.body;if(a&&null!=a){if(l=a,""!=l.bank_type&&null!=l.bank_type||(l.bank_type="NON_US"),"US"==a.bank_type&&null!=a.bank_us.swift_code){if($(".banks").hide(),a.bank_url&&a.bank_name_cn){var e=a.bank_us;e.bank_name_cn=a.bank_name_cn,e.bank_url=a.bank_url,o(e)}else b(a.bank_us);return!1}if("NON_US"==a.bank_type&&null!=a.bank_non_us.swift_code){if($(".banks").hide(),a.bank_url&&a.bank_name_cn){var s=a.bank_non_us;s.bank_name_cn=a.bank_name_cn,s.bank_url=a.bank_url,r(s)}else d(a.bank_non_us);return!1}}}function o(n){n&&(n.bank_url&&$(".bank-us .bank_url img").attr("src",n.bank_url),n.bank_name_en&&$(".bank-us .bank_name_en").html(n.bank_name_en),n.bank_name&&$(".bank-us .bank_name_en").html(n.bank_name),n.bank_swift_code&&$(".bank-us .swift_code").html("SWIFT："+n.bank_swift_code),n.swift_code&&$(".bank-us .swift_code").html("SWIFT："+n.swift_code),n.routing_number&&$(".bank-us .routing_number").val(n.routing_number),n.account_number&&$(".bank-us .account_number").val(n.account_number),"Savings"==n.account_type?$(".bank-us .account_type .savings").addClass("checked").siblings(".checking").removeClass("checked"):$(".bank-us .account_type .checking").addClass("checked").siblings(".savings").removeClass("checked")),$(".bank-us").show().siblings(".bank-us-other,.bank-cn,.bank-cn-other,.middle-bank").hide()}function r(n){n&&(""!=n.bank_url&&null!=n.bank_url&&void 0!=n.bank_url&&$(".bank-cn .bank_url img").attr("src",n.bank_url),n.bank_name_cn&&$(".bank-cn .bank_name_cn").html(n.bank_name_cn),n.bank_name_en&&$(".bank-cn .bank_name_en").html(n.bank_name_en),n.bank_name&&$(".bank-cn .bank_name_en").html(n.bank_name),n.swift_code&&$(".bank-cn .swift_code").html("SWIFT："+n.swift_code),n.bank_swift_code&&$(".bank-cn .swift_code").html("SWIFT："+n.bank_swift_code),n.account_number&&$(".bank-cn .account_number").val(n.account_number)),$(".bank-cn").show().siblings(".bank-us-other,.bank-us,.bank-cn-other,.middle-bank").hide()}function b(n){n&&(n.bank_name&&$(".bank-us-other .bank_name").val(n.bank_name),n.bank_address&&$(".bank-us-other .bank_address").val(n.bank_address),n.swift_code&&$(".bank-us-other .swift_code").val(n.swift_code),n.routing_number&&$(".bank-us-other .routing_number").val(n.routing_number),n.account_number&&$(".bank-us-other .account_number").val(n.account_number),"Savings"==n.account_type?$(".bank-us-other .account_type .savings").addClass("checked").siblings(".checking").removeClass("checked"):$(".bank-us-other .account_type .checking").addClass("checked").siblings(".savings").removeClass("checked")),$(".bank-us-other").show().siblings(".bank-cn,.bank-us,.bank-cn-other,.middle-bank").hide()}function d(n){n&&(n.bank_name&&$(".bank-cn-other .bank_name").val(n.bank_name),n.bank_address&&$(".bank-cn-other .bank_address").val(n.bank_address),n.swift_code&&$(".bank-cn-other .swift_code").val(n.swift_code),n.account_number&&$(".bank-cn-other .account_number").val(n.account_number),n.have_middle_bank&&($(".bank-cn-other .middle_bank_name").val(n.middle_bank_name),$(".bank-cn-other .middle_bank_address").val(n.middle_bank_address),$(".bank-cn-other .middle_bank_swift_code").val(n.middle_bank_swift_code))),$(".bank-cn-other,.middle-bank").show().siblings(".bank-us-other,.bank-us,.bank-cn").hide()}function c(){delete l.bank_url,delete l.bank_name_cn,delete l.bank_us.bank_url,delete l.bank_us.bank_name_cn,delete l.bank_non_us.bank_url,delete l.bank_non_us.bank_name_cn,""==m?(postData({url:base_url+"/zion/white_label/operate_user",data:JSON.stringify(l),async:!1,contentType:"application/json; charset=utf-8",sucFn:_,failFn:i}),postData({url:base_url+"/zion/white_label/create_order",data:JSON.stringify(l),async:!1,contentType:"application/json; charset=utf-8",sucFn:_,failFn:i})):postData({url:base_url+"/zion/white_label/operate_user",data:JSON.stringify(l),async:!1,contentType:"application/json; charset=utf-8",sucFn:_,failFn:i})}function _(n){var a=n.body;a&&a.order_number&&(m=a.order_number),""!==m&&(window.location="/white_label/signature.html?product_id="+h+"&phone="+k+"&partner_id="+u+"&access_token="+f+"&order_number="+m)}function i(n){alert(n.msg)}var l={},k=getUrlParam("phone")||"",u=getUrlParam("partner_id")||"",h=getUrlParam("product_id")||"",m=getUrlParam("order_number")||"",f=getUrlParam("access_token")||"",v="",p="";n(),""!=k&&""!=f&&getData({url:base_url+"/zion/white_label/order_user_info",data:{phone:k,access_token:f,channel_code:u,order_number:m},async:!1,sucFn:t,failFn:i}),$(".step-three").on("click",function(){if(l.product_id=h,l.channel_code=u,l.order_number=m,l.phone=k,l.access_token=f,$(".error").remove(),$(this).prop("disabled",!0),"block"==$(".banks").css("display"))return $(".banks").append('<div class="error">请选择银行</div>'),!1;if("block"==$(".bank-us").css("display")){var n=!0;$(".bank-us .routing_number,.bank-us .account_number").css("border-color","#ccc").removeClass("red-shadow");var a=$(".bank-us .routing_number").val(),e=$(".bank-us .account_number").val(),s=$(".bank-us .account_type .checked").html();if(""==a&&($(".bank-us .routing_number").css("border-color","red").addClass("red-shadow"),n=!1),""==e&&($(".bank-us .account_number").css("border-color","red").addClass("red-shadow"),n=!1),n)l.bank_us.routing_number=a,l.bank_us.account_number=e,l.bank_us.account_type=s,c();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}if("block"==$(".bank-us-other").css("display")){var n=!0;$(".bank-us-other .bank_name,.bank-us-other .bank_address,.bank-us-other .swift_code,.bank-us-other .routing_number,.bank-us-other .account_number").css("border-color","#ccc").removeClass("red-shadow");var o=$(".bank-us-other .bank_name").val(),r=$(".bank-us-other .bank_address").val(),b=$(".bank-us-other .swift_code").val(),a=$(".bank-us-other .routing_number").val(),e=$(".bank-us-other .account_number").val(),s=$(".bank-us-other .account_type .checked").html();if(""==o&&($(".bank-us-other .bank_name").css("border-color","red").addClass("red-shadow"),n=!1),""==r&&($(".bank-us-other .bank_address").css("border-color","red").addClass("red-shadow"),n=!1),""==b&&""==a&&($(".bank-us-other .swift_code").css("border-color","red").addClass("red-shadow"),$(".bank-us-other .routing_number").css("border-color","red").addClass("red-shadow"),n=!1),""==e&&($(".bank-us-other .account_number").css("border-color","red").addClass("red-shadow"),n=!1),n)l.bank_us.bank_name=o,l.bank_us.bank_address=r,l.bank_us.routing_number=a,l.bank_us.swift_code=b,l.bank_us.account_number=e,l.bank_us.account_type=s,c();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}if("block"==$(".bank-cn").css("display")){var n=!0;$(".bank-cn .account_number").css("border-color","#ccc").removeClass("red-shadow");var e=$(".bank-cn .account_number").val();if(""==e&&($(".bank-us-other .account_number").css("border-color","red").addClass("red-shadow"),n=!1),n)l.bank_non_us.account_number=e,console.log(JSON.stringify(l)),c();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}if("block"==$(".bank-cn-other").css("display")){var n=!0;$(".bank-cn-other .bank_name,.bank-cn-other .bank_address,.bank-cn-other .swift_code,.bank-cn-other .account_number").css("border-color","#ccc").removeClass("red-shadow");var o=$(".bank-cn-other .bank_name").val(),r=$(".bank-cn-other .bank_address").val(),b=$(".bank-cn-other .swift_code").val(),e=$(".bank-cn-other .account_number").val(),d=$(".bank-cn-other .middle_bank_name").val(),_=$(".bank-cn-other .middle_bank_address").val(),i=$(".bank-cn-other .middle_bank_swift_code").val();if(""==o&&($(".bank-cn-other .bank_name").css("border-color","red").addClass("red-shadow"),n=!1),""==r&&($(".bank-cn-other .bank_address").css("border-color","red").addClass("red-shadow"),n=!1),""==b&&($(".bank-cn-other .swift_code").css("border-color","red").addClass("red-shadow"),n=!1),""==e&&($(".bank-cn-other .account_number").css("border-color","red").addClass("red-shadow"),n=!1),n)l.bank_non_us.bank_name=o,l.bank_non_us.bank_address=r,l.bank_non_us.swift_code=b,l.bank_non_us.account_number=e,""!=d&&""!=_&&""!=i&&(l.bank_non_us.have_middle_bank=1,l.bank_non_us.middle_bank_name=d,l.bank_non_us.middle_bank_address=_,l.bank_non_us.middle_bank_swift_code=i),c();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}return!1}),$(".prev-two").click(function(){window.location="/white_label/address_info.html?product_id="+h+"&phone="+k+"&partner_id="+u+"&order_number="+m+"&access_token="+f}),$(".banks").on("click",".button-white",function(){return $(this).addClass("button-blue").removeClass("button-white"),$(this).hasClass("non-us-bank")&&($(".us-bank").addClass("button-white").removeClass("button-blue"),l.bank_type="NON_US",n()),$(this).hasClass("us-bank")&&($(".non-us-bank").addClass("button-white").removeClass("button-blue"),l.bank_type="US",e()),!1}),$(".bank-list").on("click",".choose-bank",function(){$(".step-three").prop("disabled",!1),$(".banks").hide();var n=$(".bank-list a").length,a=$(this).closest("a").index();if(a<n-1){var e;if("US"==l.bank_type)return e=v[a],e.account_number="",l.bank_us.bank_name=e.bank_name_en,l.bank_us.bank_address=e.bank_address,l.bank_us.swift_code=e.bank_swift_code,l.bank_us.routing_number=e.routing_number,o(e),!1;if("NON_US"==l.bank_type)return e=p[a],e.account_number="",l.bank_non_us.bank_name=e.bank_name_en,l.bank_non_us.bank_address=e.bank_address,l.bank_non_us.swift_code=e.bank_swift_code,l.bank_non_us.middle_bank_name=e.middle_bank_name,l.bank_non_us.middle_bank_address=e.middle_bank_address,l.bank_non_us.middle_bank_swift_code=e.middle_bank_swift_code,""!=e.middle_bank_address&&""!=e.middle_bank_swift_code&&""!=e.middle_bank_address&&(l.bank_non_us.have_middle_bank=1),console.log(JSON.stringify(l)),r(e),!1}else{if("US"==l.bank_type)return b(),!1;if("NON_US"==l.bank_type)return d(),!1}return!1}),$(".account_type button").click(function(){return!$(this).hasClass("checked")&&void $(this).addClass("checked").siblings("button").removeClass("checked")}),$(".search_bank, .bank_home").on("click",function(){return $(".step-three").prop("disabled",!1),$("input,textarea").val(""),$(".error").remove(),"US"==l.bank_type?(e(),$(".us-bank").addClass("button-blue").removeClass("button-white"),$(".non-us-bank").addClass("button-white").removeClass("button-blue"),$(".banks").show().siblings(".bank-us,.bank-us-other,.bank-cn,.bank-cn-other,.middle-bank").hide(),!1):"NON_US"==l.bank_type?(n(),$(".us-bank").addClass("button-white").removeClass("button-blue"),$(".non-us-bank").addClass("button-blue").removeClass("button-white"),$(".banks").show().siblings(".bank-us,.bank-us-other,.bank-cn,.bank-cn-other,.middle-bank").hide(),!1):void 0}),$("input,textarea").focus(function(){$(this).css("border-color","#ccc")})});