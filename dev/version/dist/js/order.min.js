$(function(){function t(t){getData({url:base_url+"/zion/order/list",data:t,headers:{mx_secret:l,mx_token:s},contentType:"application/json; charset=utf-8",sucFn:e,failFn:n})}function e(t){if(t.body&&t.body.length>0){var e=$.grep(t.body,function(t,e){return e>10},!0);"true"==d?a(e):r(e)}else $(".order-list tbody").html("无数据！");$(".search").prop("disabled",!1)}function a(t){$(".order-list tbody").html("");var e="";$.each(t,function(t,a){var r=null!=a.advisor_name?a.advisor_name:"",n=null!=a.phone?" [ "+a.phone+" ]":"",d=null!=a.product_number?a.product_number:"",l=null!=a.product_name?a.product_name:"",s=null!=a.invest_amount?a.invest_amount:"",o=null!=a.first_name?a.first_name:"",i=null!=a.last_name?a.last_name:"",u=null!=a.fa_investment_status?a.fa_investment_status:"",c=null!=a.created_at?a.created_at:"",h=null!=a.order_number?a.order_number:"";"not_commit"==u&&(u="未签署"),"not_received"==u&&(u="未入金"),"start_audit"==u&&(u="审核中"),"audit_failed"==u&&(u="审核失败"),"audit_success"==u&&(u="审核通过"),"start_interest"==u&&(u="投资中"),"refunded"==u&&(u="投资结束"),"voided"==u&&(u="已取消"),e+='<tr><td class="text-left"><a href="/orderDetails.html?order_number='+h+'">'+h+'</a></td><td class="text-left">'+d+" "+l+'</td><td class="text-left">'+o+" "+i+n+'</td><td style="{width: 5em;}">'+s+'</td><td style="{width: 5em;}">'+r+'</td><td style="{width: 5em;}">'+u+'</td><td style="{width: 5em;}">'+c+"</td></tr>"}),$(".order-list tbody").html(e)}function r(t){$(".order-list tbody").html("");var e="";$.each(t,function(t,a){var r=null!=a.advisor_name?a.advisor_name:"",n=null!=a.phone?" [ "+a.phone+" ]":"",d=null!=a.product_number?a.product_number:"",l=null!=a.product_name?a.product_name:"",s=null!=a.invest_amount?a.invest_amount:"",o=null!=a.first_name?a.first_name:"",i=null!=a.last_name?a.last_name:"",u=null!=a.fa_investment_status?a.fa_investment_status:"",c=null!=a.created_at?a.created_at:"",h=null!=a.order_number?a.order_number:"";"not_commit"==u&&(u="未签署"),"not_received"==u&&(u="未入金"),"start_audit"==u&&(u="审核中"),"audit_failed"==u&&(u="审核失败"),"audit_success"==u&&(u="审核通过"),"start_interest"==u&&(u="投资中"),"refunded"==u&&(u="投资结束"),"voided"==u&&(u="已取消"),e+='<tr><td class="text-left"><a href="/orderDetails.html?order_number='+h+'">'+h+'</a></td><td class="text-left">'+d+" "+l+'</td><td class="text-left">'+o+" "+i+n+'</td><td style="{width: 5em;}">'+s+'</td><td style="{width: 5em;}">'+r+'</td><td style="{width: 5em;}">'+u+'</td><td style="{width: 5em;}">'+c+"</td></tr>"}),$(".order-list tbody").html(e)}function n(t){$(".search").prop("disabled",!1),alert(t.msg)}var d=$.cookie("is_admin"),l=$.cookie("mx_secret"),s=$.cookie("mx_token");if("true"==d?($(".adviser").html('<label for="adviser">投资顾问</label><input type="text" class="form-control" id="adviser" placeholder="投资顾问">'),$(".order-list thead").html("<th>订单号</th><th>产品</th><th>投资人</th><th>金额</th><th>投资顾问</th><th>状态</th><th>投资日期</th>")):($(".adviser").html(""),$(".order-list thead").html("<th>订单号</th><th>产品</th><th>投资人</th><th>金额</th><th>状态</th><th>投资日期</th>")),""==window.location.search){var o="not_commit, not_received, start_audit, audit_failed, audit_success, start_interest",i={status:o};t(i)}else{var i={};i.user=getUrlParam("user"),i.product=getUrlParam("product"),i.channel_advisor_name=getUrlParam("channel_advisor_name"),t(i)}$("#invest-date").dateRangePicker({batchMode:"week-range",showShortcuts:!1,separator:" 至 "}),$(".clear-search").on("click",function(){return $("#order-number").val(""),$("#adviser").val(""),$("#user").val(""),$("#product").val(""),$("#invest-date").val(""),$('.checkbox input[type="checkbox"]').each(function(t,e){t<7?0==$(e).attr("checked")&&$(e).prop("checked",!0):1==$(e).attr("checked")&&$(e).prop("checked",!1)}),!1}),$(".search").on("click",function(){$(this).prop("disabled",!0);var e={},a=[],r=$('.checkbox input[type="checkbox"]:checked');return $.each(r,function(){a.push($(this).data("status"))}),e.number=$("#order-number").val()||"",e.product=$("#product").val()||"",e.channel_advisor_name=$("#adviser").val()||"",e.user=$("#user").val()||"",e.begin=$("#invest-date").val().split(" 至 ")[0]||"",e.end=$("#invest-date").val().split(" 至 ")[1]||"",e.status=a.join(", "),t(e),!1})});