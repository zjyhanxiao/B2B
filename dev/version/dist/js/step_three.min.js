$(function(){function n(){var n={type:"1"};getData({data:n,url:base_url+"/white_label/invest/access_bank_dic",async:!1,sucFn:a,failFn:l})}function a(n){var a=n.body;if(a&&null!=a){f=a;var e="";$.each(a,function(n,a){e+='<a><div class="col-md-4"><div class="form-line choose-bank dis_table"><div class="table_row"><span class="table_cell" style=" width: 30%; height:60px;"><img class="bank-icon"src="'+a.bank_url+'"alt=""></span><span  class="table_cell" style=" width: 70%; height:60px;"><p style="text-align: left;">'+a.bank_name_en+"</p></span></div></div></div></a>"}),e+='<a><div class="col-md-4"><div class="form-line choose-bank dis_table" style="width: 100%;"><div class="table_row"><span class="table_cell" style="width: 30%; height:60px;"><img class="bank-icon" style=" width: 38px"src="/version/dist/img/other_bank.png"alt=""></span><span class="table_cell" style=" width: 70%; height:60px;"><p style="text-align: left; font-size: 14px; line-height: 60px; color: #159bd6;">其他银行</p></span></div></div></div></a>',$(".bank-list").html(e)}}function e(){var n={type:"2"};getData({data:n,url:base_url+"/white_label/invest/access_bank_dic",async:!1,sucFn:s,failFn:l})}function s(n){var a=n.body;if(a&&null!=a){v=a;var e="";$.each(a,function(n,a){e+='<a><div class="col-md-4"><div class="form-line choose-bank dis_table"><div class="table_row"><span class="table_cell" style=" width: 30%; height:60px;"><img class="bank-icon"src="'+a.bank_url+'"alt=""></span><span  class="table_cell" style=" width: 70%; height:60px;"><p style="text-align: left;">'+a.bank_name_en+"</p></span></div></div></div></a>"}),e+='<a><div class="col-md-4"><div class="form-line choose-bank dis_table" style="width: 100%;"><div class="table_row"><span class="table_cell" style="width: 30%; height:60px;"><img class="bank-icon" style=" width: 38px"src="/version/dist/img/other_bank.png"alt=""></span><span class="table_cell" style=" width: 70%; height:60px;"><p style="text-align: left; font-size: 14px; line-height: 60px; color: #159bd6;">其他银行</p></span></div></div></div></a>',$(".bank-list").html(e)}}function t(n){var a=n.body;if(a&&null!=a){if(i=a,""!=i.bank_type&&null!=i.bank_type||(i.bank_type="NON_US"),"US"==a.bank_type&&null!=a.bank_us.swift_code){if($(".banks").hide(),a.bank_url&&a.bank_name_cn){var e=a.bank_us;e.bank_name_cn=a.bank_name_cn,e.bank_url=a.bank_url,o(e)}else b(a.bank_us);return!1}if("NON_US"==a.bank_type&&null!=a.bank_non_us.swift_code){if($(".banks").hide(),a.bank_url&&a.bank_name_cn){var s=a.bank_non_us;s.bank_name_cn=a.bank_name_cn,s.bank_url=a.bank_url,r(s)}else c(a.bank_non_us);return!1}}}function o(n){n&&(n.bank_url&&$(".bank-us .bank_url img").attr("src",n.bank_url),n.bank_name_en&&$(".bank-us .bank_name_en").html(n.bank_name_en),n.bank_name&&$(".bank-us .bank_name_en").html(n.bank_name),n.bank_swift_code&&$(".bank-us .swift_code").html("SWIFT："+n.bank_swift_code),n.swift_code&&$(".bank-us .swift_code").html("SWIFT："+n.swift_code),n.routing_number&&$(".bank-us .routing_number").val(n.routing_number),n.account_number&&$(".bank-us .account_number").val(n.account_number),"Savings"==n.account_type?$(".bank-us .account_type .savings").addClass("checked").siblings(".checking").removeClass("checked"):$(".bank-us .account_type .checking").addClass("checked").siblings(".savings").removeClass("checked")),$(".bank-us").show().siblings(".bank-us-other,.bank-cn,.bank-cn-other,.middle-bank").hide()}function r(n){n&&(""!=n.bank_url&&null!=n.bank_url&&void 0!=n.bank_url&&$(".bank-cn .bank_url img").attr("src",n.bank_url),n.bank_name_cn&&$(".bank-cn .bank_name_cn").html(n.bank_name_cn),n.bank_name_en&&$(".bank-cn .bank_name_en").html(n.bank_name_en),n.bank_name&&$(".bank-cn .bank_name_en").html(n.bank_name),n.swift_code&&$(".bank-cn .swift_code").html("SWIFT："+n.swift_code),n.bank_swift_code&&$(".bank-cn .swift_code").html("SWIFT："+n.bank_swift_code),n.account_number&&$(".bank-cn .account_number").val(n.account_number)),$(".bank-cn").show().siblings(".bank-us-other,.bank-us,.bank-cn-other,.middle-bank").hide()}function b(n){n&&(n.bank_name&&$(".bank-us-other .bank_name").val(n.bank_name),n.bank_address&&$(".bank-us-other .bank_address").val(n.bank_address),n.swift_code&&$(".bank-us-other .swift_code").val(n.swift_code),n.routing_number&&$(".bank-us-other .routing_number").val(n.routing_number),n.account_number&&$(".bank-us-other .account_number").val(n.account_number),"Savings"==n.account_type?$(".bank-us-other .account_type .savings").addClass("checked").siblings(".checking").removeClass("checked"):$(".bank-us-other .account_type .checking").addClass("checked").siblings(".savings").removeClass("checked")),$(".bank-us-other").show().siblings(".bank-cn,.bank-us,.bank-cn-other,.middle-bank").hide()}function c(n){n&&(n.bank_name&&$(".bank-cn-other .bank_name").val(n.bank_name),n.bank_address&&$(".bank-cn-other .bank_address").val(n.bank_address),n.swift_code&&$(".bank-cn-other .swift_code").val(n.swift_code),n.account_number&&$(".bank-cn-other .account_number").val(n.account_number),n.have_middle_bank&&($(".bank-cn-other .middle_bank_name").val(n.middle_bank_name),$(".bank-cn-other .middle_bank_address").val(n.middle_bank_address),$(".bank-cn-other .middle_bank_swift_code").val(n.middle_bank_swift_code))),$(".bank-cn-other,.middle-bank").show().siblings(".bank-us-other,.bank-us,.bank-cn").hide()}function d(){delete i.bank_url,delete i.bank_name_cn,delete i.bank_us.bank_url,delete i.bank_us.bank_name_cn,delete i.bank_non_us.bank_url,delete i.bank_non_us.bank_name_cn,""==m?(postData({url:base_url+"/zion/assist/operateUser",data:JSON.stringify(i),async:!1,contentType:"application/json; charset=utf-8",sucFn:_,failFn:l}),postData({url:base_url+"/zion/assist/createOrder",data:JSON.stringify(i),async:!1,contentType:"application/json; charset=utf-8",sucFn:_,failFn:l})):postData({url:base_url+"/zion/assist/operateUser",data:JSON.stringify(i),async:!1,contentType:"application/json; charset=utf-8",sucFn:_,failFn:l})}function _(n){var a=n.body;a&&a.order_number&&(m=a.order_number),""!==m&&(window.location="share.html?product_id="+h+"&phone="+k+"&partner_id="+u+"&access_token="+p+"&order_number="+m)}function l(n){alert(n.msg)}var i={},k=getUrlParam("phone")||"",u=getUrlParam("partner_id")||"",h=parseInt(getUrlParam("product_id"))||"",m=getUrlParam("order_number")||"",p=getUrlParam("access_token")||"",v="",f="";n(),""!=k&&getData({url:base_url+"/zion/assist/customerOrderInfo",data:{phone:k,order_number:m},async:!1,headers:{mx_secret:$.cookie("mx_secret"),mx_token:$.cookie("mx_token")},contentType:"application/json; charset=utf-8",sucFn:t,failFn:l}),$(".step-three").on("click",function(){if(i.product_id=h,i.channel_code=u,i.order_number=m,i.phone=k,i.access_token=p,$(".error").remove(),$(this).prop("disabled",!0),"block"==$(".banks").css("display"))return $(".banks").append('<div class="error">请选择银行</div>'),!1;if("block"==$(".bank-us").css("display")){var n=!0;$(".bank-us .routing_number,.bank-us .account_number").css("border-color","#ccc").removeClass("red-shadow");var a=$(".bank-us .routing_number").val(),e=$(".bank-us .account_number").val(),s=$(".bank-us .account_type .checked").html();if(""==a&&($(".bank-us .routing_number").css("border-color","red").addClass("red-shadow"),n=!1),""==e&&($(".bank-us .account_number").css("border-color","red").addClass("red-shadow"),n=!1),n)i.bank_us.routing_number=a,i.bank_us.account_number=e,i.bank_us.account_type=s,d();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}if("block"==$(".bank-us-other").css("display")){var n=!0;$(".bank-us-other .bank_name,.bank-us-other .bank_address,.bank-us-other .swift_code,.bank-us-other .routing_number,.bank-us-other .account_number").css("border-color","#ccc").removeClass("red-shadow");var o=$(".bank-us-other .bank_name").val(),r=$(".bank-us-other .bank_address").val(),b=$(".bank-us-other .swift_code").val(),a=$(".bank-us-other .routing_number").val(),e=$(".bank-us-other .account_number").val(),s=$(".bank-us-other .account_type .checked").html();if(""==o&&($(".bank-us-other .bank_name").css("border-color","red").addClass("red-shadow"),n=!1),""==r&&($(".bank-us-other .bank_address").css("border-color","red").addClass("red-shadow"),n=!1),""==b&&""==a&&($(".bank-us-other .swift_code").css("border-color","red").addClass("red-shadow"),$(".bank-us-other .routing_number").css("border-color","red").addClass("red-shadow"),n=!1),""==e&&($(".bank-us-other .account_number").css("border-color","red").addClass("red-shadow"),n=!1),n)i.bank_us.bank_name=o,i.bank_us.bank_address=r,i.bank_us.routing_number=a,i.bank_us.swift_code=b,i.bank_us.account_number=e,i.bank_us.account_type=s,d();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}if("block"==$(".bank-cn").css("display")){var n=!0;$(".bank-cn .account_number").css("border-color","#ccc").removeClass("red-shadow");var e=$(".bank-cn .account_number").val();if(""==e&&($(".bank-us-other .account_number").css("border-color","red").addClass("red-shadow"),n=!1),n)i.bank_non_us.account_number=e,console.log(JSON.stringify(i)),d();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}if("block"==$(".bank-cn-other").css("display")){var n=!0;$(".bank-cn-other .bank_name,.bank-cn-other .bank_address,.bank-cn-other .swift_code,.bank-cn-other .account_number").css("border-color","#ccc").removeClass("red-shadow");var o=$(".bank-cn-other .bank_name").val(),r=$(".bank-cn-other .bank_address").val(),b=$(".bank-cn-other .swift_code").val(),e=$(".bank-cn-other .account_number").val(),c=$(".bank-cn-other .middle_bank_name").val(),_=$(".bank-cn-other .middle_bank_address").val(),l=$(".bank-cn-other .middle_bank_swift_code").val();if(""==o&&($(".bank-cn-other .bank_name").css("border-color","red").addClass("red-shadow"),n=!1),""==r&&($(".bank-cn-other .bank_address").css("border-color","red").addClass("red-shadow"),n=!1),""==b&&($(".bank-cn-other .swift_code").css("border-color","red").addClass("red-shadow"),n=!1),""==e&&($(".bank-cn-other .account_number").css("border-color","red").addClass("red-shadow"),n=!1),n)i.bank_non_us.bank_name=o,i.bank_non_us.bank_address=r,i.bank_non_us.swift_code=b,i.bank_non_us.account_number=e,""!=c&&""!=_&&""!=l&&(i.bank_non_us.have_middle_bank=1,i.bank_non_us.middle_bank_name=c,i.bank_non_us.middle_bank_address=_,i.bank_non_us.middle_bank_swift_code=l),d();else{var t=$(".red-shadow").eq(0).offset().top;$("body").scrollTop(t),$(this).prop("disabled",!1)}return!1}return!1}),$(".prev-two").click(function(){window.location="/auxiliary_order/stepTwo.html?product_id="+h+"&phone="+k+"&partner_id="+u+"&order_number="+m}),$(".banks").on("click",".button-white",function(){return $(this).addClass("button-blue").removeClass("button-white"),$(this).hasClass("non-us-bank")&&($(".us-bank").addClass("button-white").removeClass("button-blue"),i.bank_type="NON_US",n()),$(this).hasClass("us-bank")&&($(".non-us-bank").addClass("button-white").removeClass("button-blue"),i.bank_type="US",e()),!1}),$(".bank-list").on("click",".choose-bank",function(){$(".step-three").prop("disabled",!1),$(".banks").hide();var n=$(".bank-list a").length,a=$(this).closest("a").index();if(a<n-1){var e;if("US"==i.bank_type)return e=v[a],e.account_number="",i.bank_us.bank_name=e.bank_name_en,i.bank_us.bank_address=e.bank_address,i.bank_us.swift_code=e.bank_swift_code,i.bank_us.routing_number=e.routing_number,o(e),!1;if("NON_US"==i.bank_type)return e=f[a],e.account_number="",i.bank_non_us.bank_name=e.bank_name_en,i.bank_non_us.bank_address=e.bank_address,i.bank_non_us.swift_code=e.bank_swift_code,i.bank_non_us.middle_bank_name=e.middle_bank_name,i.bank_non_us.middle_bank_address=e.middle_bank_address,i.bank_non_us.middle_bank_swift_code=e.middle_bank_swift_code,""!=e.middle_bank_address&&""!=e.middle_bank_swift_code&&""!=e.middle_bank_address&&(i.bank_non_us.have_middle_bank=1),r(e),!1}else{if("US"==i.bank_type)return b(),!1;if("NON_US"==i.bank_type)return c(),!1}return!1}),$(".account_type button").click(function(){return!$(this).hasClass("checked")&&void $(this).addClass("checked").siblings("button").removeClass("checked")}),$(".bank_border").on("click",function(){return $(".step-three").prop("disabled",!1),$("input,textarea").val(""),$(".error").remove(),"US"==i.bank_type?(e(),$(".us-bank").addClass("button-blue").removeClass("button-white"),$(".non-us-bank").addClass("button-white").removeClass("button-blue"),$(".banks").show().siblings(".bank-us,.bank-us-other,.bank-cn,.bank-cn-other,.middle-bank").hide(),!1):"NON_US"==i.bank_type?(n(),$(".us-bank").addClass("button-white").removeClass("button-blue"),$(".non-us-bank").addClass("button-blue").removeClass("button-white"),$(".banks").show().siblings(".bank-us,.bank-us-other,.bank-cn,.bank-cn-other,.middle-bank").hide(),!1):void 0}),$("input,textarea").focus(function(){$(this).css("border-color","#ccc")})});